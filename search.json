[{"title":"xss-labs详解（下）11-20","date":"2020-08-04T16:39:00.000Z","url":"/2020/08/05/xss-labs%E8%AF%A6%E8%A7%A3%EF%BC%88%E4%B8%8B%EF%BC%8911-20/","tags":[["XSS-Labs","/tags/XSS-Labs/"]],"categories":[["XSS-Labs","/categories/XSS-Labs/"]],"content":"Level 11查看一波源代码，发现可能在这里存在xss那么我们使用burp抓包,修改 果不其然他是把上一关的链接加上了 Level 12我们先看一下源代码这次他的值明显就是useragent的内容了 这个$_SERVER[‘HTTP_USER_AGENT’]就是来获取的 Level 13看源代码觉得和10关很相似，我们全部自己构造参数试试构造普通一句话只有这里有回显第一个是refer第二个是useragant猜测这个就是cookie的xss了 Level 14 我们查询一下，需要访问这个网页，我们使用某种不存在的东西，访问一下可交换图像文件格式（英语：Exchangeable image file format，官方简称Exif），是专门为数码相机的照片设定的，可以记录数码照片的属性信息和拍摄数据。 将XSS写到Exif里（PowerExif）exif是PHP拓展，如果要用exif_read_data函数要记得开启拓展。这是使用demo ==linux系统使用exiftool工具，进行修改。windows系统直接使用鼠标右键进入属性页面直接修改。==在配置文件php.ini中找到php_exif.dll将其加载顺序替换到php_mbstring.dll的后面，重启Apache打开页面进行读取，弹窗成功这个网站可以修改 Level 15 被墙了我们换一个 ng-include 指令用于包含外部的 HTML 文件。包含的内容将作为指定元素的子节点。 可以看到我们提交的参数src的值被插入到了标签的class属性值中，但是前面还有ng-include这样的字符。 ng-include是angular js中的东西，其作用相当于php的include函数。这里就是将1.png这个文件给包含进来我们这么构造 就相当于访问了一次level1，同时让1执行了xss ng-include1.ng-include,如果单纯指定地址，必须要加引号2.ng-include,加载外部html，script标签中的内容不执行3.ng-include,加载外部html中含有style标签样式可以识别 1，ng-include指令用于包含外部的HTML文件。 2，包含的内容将作为指定元素的子节点。 3，ng-include属性的值可以是一个表达式，返回一个文件名。 4，某种情况下，包含的文件需要包含在同一个域名下。 onerror Level 16经典一句话，基本都被过滤了，发现scrip和/被编码为&amp;nbsp;因为这里把空格都编码了，也就意味着我们无法通过空间来将字符分隔进行语义的区分，不过我们还可以用回车来将它们分开。而且这里将/符号也编码了，所以我们需要的是一个不需要封闭的标签，在一开始之前用过的 可以用回车的URL编码格式％0a来表示。当然％0d也可以。 可以看到关键字script以及/符号，空格都被替换成相同的空间字符实体了。这样也没办法去封闭前面的标签了。 Level 17 他有两个参数，我们都来一句话看看发现过滤了括号他这里提示了xsf，是一个flash攻击它本身的src并没有引号，所以我们直接输入即可火狐没有flash，我们来chrome但是谷歌把xss防住了 直接使用onclick或者onmouseover即可 Level 1818关同17关 Level 19因为chrome和fire都不让flash运行，我们只能打开iesrc的值使用双引号括起来的这里有师傅的具体操作 href=&quot;javascript:alert(/xss/)&quot;&gt;xss&lt;/a&gt; Level 20level20 仍然是flash的xss一片空白的20关师傅的博客 这关确实没思路了可以试试flash xss扫描工具"},{"title":"攻防世界web进阶区web2详解","date":"2020-08-04T10:57:00.000Z","url":"/2020/08/04/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BAweb2%E8%AF%A6%E8%A7%A3/","tags":[["攻防世界","/tags/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C/"],["web进阶区","/tags/web%E8%BF%9B%E9%98%B6%E5%8C%BA/"]],"categories":[["CTF","/categories/CTF/"]],"content":"题目 解法 我们这里来审计一波for循环，从0到循环到字符串长度从$_o开始之后$_0长度的字符开始寻找，长度为1的输出给了$_c php脚本如下 strrev函数反转字符串 substr从第六位开始，返回之后的值 ord返回第一个字母的ASCII chr()从指定的ascii值返回字符4的十进制ascii是52 str_rot13()一种编码解码函数对字符串执行 ROT13 转换,ROT13 编码简单地使用字母表中后面第 13 个字母替换当前字母，同时忽略非字母表中的字符。编码和解码都使用相同的函数，传递一个编码过的字符串作为参数，将得到原始字符串。"},{"title":"xss-labs详解(上)1-10","date":"2020-08-03T02:26:00.000Z","url":"/2020/08/03/first-post/","categories":[["XSS-Labs","/categories/XSS-Labs/"]],"content":"Level 1源码 最基本的，我们直接插入语句&lt;script&gt;alert(1)&lt;/script&gt; Level 2 这些被预编译了这里我们看到还有一个submit，他是input的弹窗，我们在这里进行闭合 源码也可以看到，input的标签，并没有过滤，&quot;&gt; &lt;script&gt;alert(&#39;xss&#39;)&lt;/script&gt; //我们闭合前面， 注释后面，完成！ htmlspecialchars把预定义的字符 “&lt;” （小于）和 “&gt;” （大于）转换为 HTML 实体：实体化函数，也是一种预编译的函数，相当于&lt;&gt;不起作用了 Level 3 正常输入并不可以，我们进行代码审计使用了两次 htmlspecialchars而我们的htmlspecialchars 默认不对&#39;生效正好这里的value是&#39;闭合的我们看到这儿，value也闭合了，onlick也闭合了，只要点击value空白处，就能触发&#39; onclick=&#39;javascript:alert(/xss/)&#39;onclick=&#39;alert(/xss/) &#39; onmouseover=&#39;javascript:alert(/xss/)&#39;onmouseover=&#39;alert(/xss/)这两个都可以 JavaScript伪协议伪协议不同于因特网上所真实存在的协议，如http://，https://，ftp://， 而是为关联应用程序而使用的.如:tencent://(关联QQ)，data:(用base64编码来在浏览器端输出二进制文件)，还有就是javascript: 我们可以在浏览地址栏里输入”javascript:alert(‘JS!’);”，点转到后会发现，实际上是把javascript:后面的代码当JavaScript来执行，并将结果值返回给当前页面。 Level 4 他这里只是把尖括号替换为了空我们上我们的经典语句发现了转义，他把尖括号转义了但是这里并没有进行过滤我们直接构造闭合value即可 Level 5一套经典操作过后，发现，单引号没有被转义发现第一个script被过滤了一点那么我们再试试onclick发现onclick也是那么我们只能把input的标签闭合，然后在定义新的一个没有on的语句&quot;&gt; &lt;a href=&quot;javascript:alert(&#39;xss&#39;)&quot;&gt; 我们来查看一下源代码将script和on都替换了 Level 6同样一套灌下去，发现单引号并没有，然后script被过滤了我们使用第五关的代码，发现href也被过滤了因为str_replace是区分大小写的那么我们把script或者href大写区分一下就好了 查看一下源码，他增添了几个过滤 Level 7经典语句之后，发现，被置为了空，那么我们双写绕过发现可以，那么我们闭合之前的括号即可&quot;&gt;&lt;script&gt;alert(&#39;1&#39;)&lt;/script&gt; Level 8标准一把梭，发现增加了友情链接发现被禁了，同时将script给过滤了我们测试又发现，onclick和jaavascript过滤了基本都被过滤了，那么我们试试实体化编码绕过就是将他编译过后的在存储进去，那么我们最终显示出来的就是我们需要的代码可以看看这里的解释这里我们将他实体化，这是在线网站：(1) strtolower将所有变为小写，防止大小写绕过 Level 9经典一句话，发现他说不合法，那么猜一手匹配相应字符哦~第八关的实体化代码输入不进去那么我们猜一猜匹配的字符是什么网址的话猜一下http://发现我们的链接存在了，那么我们将上一关的代码补上注意一定要将他http：//注释掉 看代码，果然是匹配了http:// Level 10第十个，打开只有一张图片，那么猜一下应该是从图片入手看源代码，发现了三个隐藏的input框我们把他隐藏的hidden删掉没有发送按键，那只能在hackbar直接构造了我们把所有的参数都改成我们的一句话，冲冲冲！我们发现只有第三个有回显，和之前的很像，而且她过滤了括号我们猜测使用javascript伪协议 实体化也没能绕过说明他源代码并没有进行实体化，那么我们考虑考虑直接xss发现也不可以，我们把type删掉，然后点击空白框即可&amp;t_sort=&quot; onclick= &quot;alert(/xss/) 将尖括号屏蔽了，其他没有什么，"}]